<!DOCTYPE html>
<html>
<head>
    <style type = 'text/css' media='screen'>
        #upload-message {
            visibility: hidden;
        }
    </style>
</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script type="text/javascript">

function toDataURL(url, callback) {
    var httpRequest = new XMLHttpRequest();
    httpRequest.onload = function() {
        var fileReader = new FileReader();
        fileReader.onloadend = function() {
            callback(fileReader.result);
        }
        fileReader.readAsDataURL(httpRequest.response);
    };

    httpRequest.responseType = 'blob';
    httpRequest.open('GET', url); // 'GET' will be ignored because the url is non-HTTP
    httpRequest.send();
}

function encodeImageFileAsURL() {

    var filesSelected = document.getElementById("file-upload").files;
    if (filesSelected.length > 0) {
      var fileToLoad = filesSelected[0];

      var fileReader = new FileReader();

      fileReader.onload = function(fileLoadedEvent) {
        var srcData = fileLoadedEvent.target.result; // <--- data: base64

        // var newImage = document.createElement('img');
        // newImage.src = srcData;

        passImage(srcData)

        // document.getElementById("imgTest").innerHTML = newImage.outerHTML;
        // alert("Converted Base64 version is " + document.getElementById("imgTest").innerHTML);
        // console.log("Converted Base64 version is " + document.getElementById("imgTest").innerHTML);
      }
      fileReader.readAsDataURL(fileToLoad);
    }
  }

window.onload = function() {
	// setup the button click
	document.getElementById("submit-button").onclick = function() {
		if(document.getElementById("file-upload").value.length > 0) {
		    /*
		    toDataURL(document.getElementById("file-upload").value[0], function(imgString) {
		    passImage(imgString)
		    })
		    */
		    encodeImageFileAsURL()
		}
        else {
            document.getElementById("upload-message").style.visibility="visible";
        }
	};
}

function passImage(img) {
	// ajax the JSON to the server
	$.post("receiver", JSON.stringify(img), function() {

	});
	// stop link reloading the page
 event.preventDefault();
}
</script>
Valid image formats: PGN, JPEG.<br /><br />
<input type="file" id="file-upload" accept="image/png, image/jpeg">
<input type="submit" id="submit-button" value="Read Game">
<p id="upload-message">Please upload a file.</p>
</body>
</html>